<?php

namespace Database\Seeders;

use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;
use App\Models\KnowledgeArticle;

class KnowledgeSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        $articles = [
            [
                'category' => 'getting-started',
                'title' => 'Настройка ролей и доступов',
                'description' => 'Пошаговая инструкция по настройке ролей и прав доступа для пользователей системы',
                'content' => '<h2>Настройка ролей и доступов</h2>
                
<h3>Шаг 1. Переход в раздел "Роли и доступы"</h3>
<p>Откройте меню <strong>Настройки</strong> и выберите раздел <strong>Роли и доступы</strong>.</p>

<h3>Шаг 2. Создание ролей</h3>
<p>Нажмите кнопку <strong>Добавить роль</strong> и введите название роли (например: Администратор, Менеджер, Мастер и т.д.).</p>

<h3>Шаг 3. Настройка доступов</h3>
<p>Для каждой роли выберите пункты меню, к которым будет открыт доступ. Если доступ к определённому пункту меню закрыт, этот пункт всё равно будет отображаться в меню, но:</p>
<ul>
    <li>рядом с ним будет значок замка;</li>
    <li>он будет подсвечен тусклым цветом;</li>
    <li>переход по нему будет невозможен (не кликабелен).</li>
</ul>

<h3>Пример:</h3>
<p>Если у роли "Мастер" закрыт доступ к разделу <strong>Отчёты</strong>, то в меню этот пункт будет отображён с замочком и не будет активным.</p>',
                'author' => 'Команда Trimora',
                'is_published' => true,
                'published_at' => now(),
                'sort_order' => 1
            ],
            [
                'category' => 'getting-started',
                'title' => 'Первые шаги в системе',
                'description' => 'Быстрый старт: основные функции и настройки для новых пользователей',
                'content' => '<h2>Первые шаги в системе</h2>
                
<h3>Добро пожаловать в Trimora!</h3>
<p>Это руководство поможет вам быстро освоить основные функции системы и начать работу.</p>

<h3>1. Настройка профиля</h3>
<p>Первым делом настройте свой профиль пользователя:</p>
<ul>
    <li>Загрузите фотографию профиля</li>
    <li>Укажите контактную информацию</li>
    <li>Настройте уведомления</li>
</ul>

<h3>2. Изучение интерфейса</h3>
<p>Ознакомьтесь с основными разделами:</p>
<ul>
    <li><strong>Дашборд</strong> - обзор важной информации</li>
    <li><strong>Клиенты</strong> - управление клиентской базой</li>
    <li><strong>Записи</strong> - планирование встреч</li>
    <li><strong>Отчёты</strong> - аналитика и статистика</li>
</ul>

<h3>3. Первые действия</h3>
<p>Начните с простых задач:</p>
<ul>
    <li>Добавьте первого клиента</li>
    <li>Создайте первую запись</li>
    <li>Изучите настройки уведомлений</li>
</ul>',
                'author' => 'Команда Trimora',
                'is_published' => true,
                'published_at' => now(),
                'sort_order' => 2
            ],
            [
                'category' => 'features',
                'title' => 'Автоматизация процессов',
                'description' => 'Как настроить автоматические уведомления и напоминания для повышения эффективности',
                'content' => '<h2>Автоматизация процессов</h2>
                
<h3>Преимущества автоматизации</h3>
<p>Автоматизация рутинных задач позволяет:</p>
<ul>
    <li>Сэкономить время на повторяющихся операциях</li>
    <li>Снизить количество ошибок</li>
    <li>Повысить качество обслуживания клиентов</li>
    <li>Улучшить планирование работы</li>
</ul>

<h3>Настройка автоматических уведомлений</h3>
<p>В системе можно настроить:</p>
<ul>
    <li><strong>Напоминания о записях</strong> - автоматические SMS и email</li>
    <li><strong>Уведомления о новых клиентах</strong></li>
    <li><strong>Напоминания о задачах</strong></li>
    <li><strong>Отчёты по расписанию</strong></li>
</ul>

<h3>Пример настройки</h3>
<p>Для автоматических напоминаний о записях:</p>
<ol>
    <li>Перейдите в Настройки → Уведомления</li>
    <li>Выберите тип уведомления "Напоминание о записи"</li>
    <li>Укажите время отправки (например, за 2 часа)</li>
    <li>Выберите способ доставки (SMS, email, Telegram)</li>
    <li>Сохраните настройки</li>
</ol>',
                'author' => 'Команда Trimora',
                'is_published' => true,
                'published_at' => now(),
                'sort_order' => 3
            ],
            [
                'category' => 'integrations',
                'title' => 'Подключение Telegram',
                'description' => 'Инструкция по настройке интеграции с Telegram для автоматических уведомлений',
                'content' => '<h2>Подключение Telegram</h2>
                
<h3>Что даёт интеграция с Telegram</h3>
<p>Подключение Telegram позволяет:</p>
<ul>
    <li>Получать уведомления о новых записях</li>
    <li>Отправлять напоминания клиентам</li>
    <li>Получать уведомления о важных событиях</li>
    <li>Управлять системой через бота</li>
</ul>

<h3>Пошаговая настройка</h3>
<p><strong>Шаг 1:</strong> Создание бота</p>
<ol>
    <li>Найдите @BotFather в Telegram</li>
    <li>Отправьте команду /newbot</li>
    <li>Следуйте инструкциям для создания бота</li>
    <li>Сохраните полученный токен</li>
</ol>

<p><strong>Шаг 2:</strong> Настройка в системе</p>
<ol>
    <li>Перейдите в Настройки → Telegram</li>
    <li>Введите токен бота</li>
    <li>Укажите ID чата для уведомлений</li>
    <li>Протестируйте подключение</li>
</ol>

<h3>Тестирование</h3>
<p>После настройки отправьте тестовое сообщение для проверки работы интеграции.</p>',
                'author' => 'Команда Trimora',
                'is_published' => true,
                'published_at' => now(),
                'sort_order' => 4
            ]
        ];

        foreach ($articles as $article) {
            $article['slug'] = \Str::slug($article['title']);
            KnowledgeArticle::create($article);
        }

        $this->command->info('Тестовые статьи базы знаний успешно добавлены!');
    }
}
